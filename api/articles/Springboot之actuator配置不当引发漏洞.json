{"title":"Springboot之actuator配置不当引发漏洞","uid":"3126e077d4a90cee169e013b88d8de20","slug":"Springboot之actuator配置不当引发漏洞","date":"2021-10-13T12:56:13.927Z","updated":"2021-10-13T12:58:50.556Z","comments":true,"path":"api/articles/Springboot之actuator配置不当引发漏洞.json","keywords":null,"cover":[],"content":"<h1 id=\"一、actuator介绍\"><a href=\"#一、actuator介绍\" class=\"headerlink\" title=\"一、actuator介绍\"></a>一、actuator介绍</h1><p>Actuator 是 springboot 提供的用来对应用系统进行自省和监控的功能模块，借助于 Actuator 开发者可以很方便地对应用系统某些监控指标进行查看、统计等。在 Actuator 启用的情况下，如果没有做好相关权限控制，非法用户可通过访问默认的执行器端点（endpoints）来获取应用系统中的监控信息。</p>\n<p>其提供的执行器端点分为两类：原生端点和用户自定义扩展端点，原生端点主要有：</p>\n<table>\n<thead>\n<tr>\n<th>Http 方法</th>\n<th>路径</th>\n<th>描述</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>get</td>\n<td>/autoconfig</td>\n<td>提供了一份自动配置报告，记录哪些自动配置条件通过了，哪些没通过</td>\n</tr>\n<tr>\n<td>get</td>\n<td>/configprops</td>\n<td>描述配置属性（包含默认值）如何注入 Bean</td>\n</tr>\n<tr>\n<td>get</td>\n<td>/beans</td>\n<td>描述应用程序上下文里全部的 Bean，以及它们的关系</td>\n</tr>\n<tr>\n<td>get</td>\n<td>/dump</td>\n<td>获取线程活动的快照</td>\n</tr>\n<tr>\n<td>get</td>\n<td>/env</td>\n<td>获取全部环境属性</td>\n</tr>\n<tr>\n<td>get</td>\n<td>/env/{name}</td>\n<td>根据名称获取特定的环境属性值</td>\n</tr>\n<tr>\n<td>get</td>\n<td>/health</td>\n<td>报告应用程序的健康指标，这些值由 HealthIndicator 的实现类提供</td>\n</tr>\n<tr>\n<td>get</td>\n<td>/info</td>\n<td>获取应用程序的定制信息，这些信息由 info 打头的属性提供</td>\n</tr>\n<tr>\n<td>get</td>\n<td>/mappings</td>\n<td>描述全部的 URI 路径，以及它们和控制器（包含 Actuator 端点）的映射关系</td>\n</tr>\n<tr>\n<td>get</td>\n<td>/metrics</td>\n<td>报告各种应用程序度量信息，比如内存用量和 HTTP 请求计数</td>\n</tr>\n<tr>\n<td>get</td>\n<td>/metrics/{name}</td>\n<td>报告指定名称的应用程序度量值</td>\n</tr>\n<tr>\n<td>post</td>\n<td>/shutdown</td>\n<td>关闭应用程序，要求 endpoints.shutdown.enabled 设置为 true（默认为 false）</td>\n</tr>\n<tr>\n<td>get</td>\n<td>/trace</td>\n<td>提供基本的 HTTP 请求跟踪信息（时间戳、HTTP 头等）</td>\n</tr>\n</tbody></table>\n<h1 id=\"二、漏洞发现\"><a href=\"#二、漏洞发现\" class=\"headerlink\" title=\"二、漏洞发现\"></a>二、漏洞发现</h1><p>一般来说，挖掘 actuator 配置不当的漏洞分如下两步：</p>\n<blockquote><span class=\"custom-blockquote-svg\"><svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"\" xmlns=\"http://www.w3.org/2000/svg\" data-reactroot=\"\">\n<path fill=\"\" d=\"M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\" undefined=\"1\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\"></path>\n</svg>\n</span><ol>\n<li>识别当前 web 应用使用的框架为 springboot 框架；2. 枚举执行器端点路径；下面针对这两步结合笔者漏洞挖掘中遇到的实例具体来说说。</li>\n</ol></blockquote>\n<ol>\n<li>识别当前 web 应用使用的框架为 springboot 框架。主要有两个方法判断：</li>\n</ol>\n<blockquote><span class=\"custom-blockquote-svg\"><svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"\" xmlns=\"http://www.w3.org/2000/svg\" data-reactroot=\"\">\n<path fill=\"\" d=\"M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\" undefined=\"1\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\"></path>\n</svg>\n</span><p>①通过 web 应用程序网页标签的图标（favicon.ico）；如果 web 应用开发者没有修改 springboot web 应用的默认图标，那么进入应用首页后可以看到如下默认的绿色小图标：</p></blockquote>\n<p><img src=\"https://tcs.teambition.net/storage/312ac59983c48c0680deb61a6a5656e0c8d1?Signature=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJBcHBJRCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9hcHBJZCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9vcmdhbml6YXRpb25JZCI6IiIsImV4cCI6MTYzNDczNDQ3NSwiaWF0IjoxNjM0MTI5Njc1LCJyZXNvdXJjZSI6Ii9zdG9yYWdlLzMxMmFjNTk5ODNjNDhjMDY4MGRlYjYxYTZhNTY1NmUwYzhkMSJ9.aGVoJ13bi7PL5cSTOWxJUdaj9Baw9GhhtV_9-ZbGCGM&download=5na2h4tidusuucelpos4a.png\"></p>\n<p>该绿色小图标是 spring 框架下的一个默认图标，尽管不能百分百就此图标确认当前 web 应用使用的是 springboot 框架，但是基本上也能百分之八十确认该 web 应用是使用 springboot 框架开发的了（毕竟 springboot 框架确实是太流行了）。</p>\n<blockquote><span class=\"custom-blockquote-svg\"><svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"\" xmlns=\"http://www.w3.org/2000/svg\" data-reactroot=\"\">\n<path fill=\"\" d=\"M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\" undefined=\"1\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\"></path>\n</svg>\n</span><p>②通过 springboot 框架默认报错页面；如果 web 应用开发者没有修改 springboot web 应用的默认 4xx、5xx 报错页面，那么当 web 应用程序出现 4xx、5xx 错误时，会报错如下（此处仅以 404 报错页面为例）：</p></blockquote>\n<p><img src=\"https://tcs.teambition.net/storage/312a9874b1f5150e7674d7cddad14f861279?Signature=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJBcHBJRCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9hcHBJZCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9vcmdhbml6YXRpb25JZCI6IiIsImV4cCI6MTYzNDczNDQ3NSwiaWF0IjoxNjM0MTI5Njc1LCJyZXNvdXJjZSI6Ii9zdG9yYWdlLzMxMmE5ODc0YjFmNTE1MGU3Njc0ZDdjZGRhZDE0Zjg2MTI3OSJ9.1sFtKACKaXwIDWKcm06heo9CeaDfEI10UMqkwo3ASzs&download=qrwlxdwgwic4w93pyhggg.png\"></p>\n<p>当出现如上报错页面，就能确定当前 web 应用是使用了 springboot 框架的。</p>\n<blockquote><span class=\"custom-blockquote-svg\"><svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"\" xmlns=\"http://www.w3.org/2000/svg\" data-reactroot=\"\">\n<path fill=\"\" d=\"M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\" undefined=\"1\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\"></path>\n</svg>\n</span><p>那么综合以上两个途径来判断当前 web 应用是否是 springboot 框架，就是通过访问不同的目录，看是否有小绿叶图标，然后就是想办法在不同目录下触发应用程序的 4xx 或 5xx 错误，看是否有 Whitelabel Error Page 报错。   </p></blockquote>\n<ol start=\"2\">\n<li>枚举执行器端点路径。这个其实很简单，在确认当前 web 站点是 springboot 框架后，枚举当前站点的所有一级、二级甚至三级目录，然后写脚本对每个目录进行探测，查看目录下是否存在 actuator 执行端点路径即可。</li>\n</ol>\n<h1 id=\"三、漏洞利用\"><a href=\"#三、漏洞利用\" class=\"headerlink\" title=\"三、漏洞利用\"></a>三、漏洞利用</h1><p>通过如上步骤，如果你发现了 actuator 的配置不当漏洞，那就要恭喜你啦。不过，尽管这些监控信息的泄露已经足够高危了，有时候碰到一些比较严格的厂商，需要你证明一下这些监控信息的具体危害，或者你想要将危害等级提升到严重，或者想要通过这些监控信息进一步挖掘其他漏洞，该怎么利用呢？笔者通过自身的踩坑经历，总结了如下几个点来尽可能最大化的利用该漏洞：        </p>\n<blockquote><span class=\"custom-blockquote-svg\"><svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"\" xmlns=\"http://www.w3.org/2000/svg\" data-reactroot=\"\">\n<path fill=\"\" d=\"M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\" undefined=\"1\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\"></path>\n</svg>\n</span><p>①认证字段的获取以证明可影响其他用户；这个主要通过访问/trace 路径获取用户认证字段信息，比如如下站点存在 actuator 配置不当漏洞，在其 trace 路径下，除了记录有基本的 HTTP 请求信息（时间戳、HTTP 头等），还有用户 token、cookie 字段：</p></blockquote>\n<p>trace 路径：</p>\n<p><img src=\"https://tcs.teambition.net/storage/312aa50464b1e624704fe2a1dbbd04c8f721?Signature=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJBcHBJRCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9hcHBJZCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9vcmdhbml6YXRpb25JZCI6IiIsImV4cCI6MTYzNDczNDQ3NSwiaWF0IjoxNjM0MTI5Njc1LCJyZXNvdXJjZSI6Ii9zdG9yYWdlLzMxMmFhNTA0NjRiMWU2MjQ3MDRmZTJhMWRiYmQwNGM4ZjcyMSJ9.iMB04jjYOxw-P2z8zT2y0piZQSSZGNnhX6sdHK9BWzk&download=qdwskgqmpyyzf1ufjdeqj.png\"></p>\n<p>用户认证字段泄露：</p>\n<p><img src=\"https://tcs.teambition.net/storage/312a1248d1b70bb87dcfa846ced3a90ef323?Signature=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJBcHBJRCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9hcHBJZCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9vcmdhbml6YXRpb25JZCI6IiIsImV4cCI6MTYzNDczNDQ3NSwiaWF0IjoxNjM0MTI5Njc1LCJyZXNvdXJjZSI6Ii9zdG9yYWdlLzMxMmExMjQ4ZDFiNzBiYjg3ZGNmYTg0NmNlZDNhOTBlZjMyMyJ9.qVhcs9N2uKmeWAfsDsx37-4oxRHpU2UV3uZBesiELSo&download=jhxszzhcdzxc9fkeku39k.png\"></p>\n<p>通过替换 token 字段可获取其他用户的信息：</p>\n<p><img src=\"https://tcs.teambition.net/storage/312a4e3206325ee9db8140b3dc703ac465cc?Signature=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJBcHBJRCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9hcHBJZCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9vcmdhbml6YXRpb25JZCI6IiIsImV4cCI6MTYzNDczNDQ3NSwiaWF0IjoxNjM0MTI5Njc1LCJyZXNvdXJjZSI6Ii9zdG9yYWdlLzMxMmE0ZTMyMDYzMjVlZTlkYjgxNDBiM2RjNzAzYWM0NjVjYyJ9.l6JrC6W7XZJ9zBZdHZpSF1nV8J1b_DGQ0WIlAkBJJCo&download=mj3fj0q4rzef-qdqxhxb0.png\"></p>\n<p>②数据库账户密码泄露；由于 actuator 会监控站点 mysql、mangodb 之类的数据库服务，所以通过监控信息有时可以拿下 mysql、mangodb 数据库；这个主要通过/env 路径获取这些服务的配置信息，比如如下站点存在 actuator 配置不当漏洞，通过其/env 路径，可获得 mysql、mangodb 的用户名及密码：</p>\n<p><img src=\"https://tcs.teambition.net/storage/312af9cc5ef7f6a577f8994e1b9c2d6a958b?Signature=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJBcHBJRCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9hcHBJZCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9vcmdhbml6YXRpb25JZCI6IiIsImV4cCI6MTYzNDczNDQ3NSwiaWF0IjoxNjM0MTI5Njc1LCJyZXNvdXJjZSI6Ii9zdG9yYWdlLzMxMmFmOWNjNWVmN2Y2YTU3N2Y4OTk0ZTFiOWMyZDZhOTU4YiJ9.Kd_mI_xPxKcGlABUatfXEdPap2bp2iWiu2unDJ9J2qc&download=cjzwzamxceh-7qbbcwfqj.png\"></p>\n<p>mangodb 及 mysql 都可直连，此处以 mysql 为例：</p>\n<p><img src=\"https://tcs.teambition.net/storage/312a1ddbb627fb88967c6445250a49e6067f?Signature=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJBcHBJRCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9hcHBJZCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9vcmdhbml6YXRpb25JZCI6IiIsImV4cCI6MTYzNDczNDQ3NSwiaWF0IjoxNjM0MTI5Njc1LCJyZXNvdXJjZSI6Ii9zdG9yYWdlLzMxMmExZGRiYjYyN2ZiODg5NjdjNjQ0NTI1MGE0OWU2MDY3ZiJ9.0KMHHpJrxyQ0ZxSkUYOTqLPd-oMD52EZdqhxROYcCnY&download=bjthaqob4wfidb8zvio4b.png\"></p>\n<p>该漏洞详情请见<a href=\"https://dvpnet.io/info/detail/id/814\"><strong>https://dvpnet.io/info/detail/id/814</strong></a>，是笔者去年在 dvp 平台提交的一个漏洞。一旦数据库外连成功，漏洞分分钟高危变严重啊。</p>\n<p>③git 项目地址泄露；这个一般是在/health 路径，比如如下站点，访问其 health 路径可探测到站点 git 项目地址：</p>\n<p><img src=\"https://tcs.teambition.net/storage/312adae3821452f6f38c4553566c45f14839?Signature=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJBcHBJRCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9hcHBJZCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9vcmdhbml6YXRpb25JZCI6IiIsImV4cCI6MTYzNDczNDQ3NSwiaWF0IjoxNjM0MTI5Njc1LCJyZXNvdXJjZSI6Ii9zdG9yYWdlLzMxMmFkYWUzODIxNDUyZjZmMzhjNDU1MzU2NmM0NWYxNDgzOSJ9.ZqNVT5GPZ05wEmDZEwuOtbsCREJqzg_BQ3vIIkIeNAc&download=yhvtby2f89bz87m0uuomc.png\"></p>\n<p>直接访问 git 项目地址，可拿下源码：</p>\n<p><img src=\"https://tcs.teambition.net/storage/312a48244ae89ce0ec68a9f22da69f27ce8a?Signature=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJBcHBJRCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9hcHBJZCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9vcmdhbml6YXRpb25JZCI6IiIsImV4cCI6MTYzNDczNDQ3NSwiaWF0IjoxNjM0MTI5Njc1LCJyZXNvdXJjZSI6Ii9zdG9yYWdlLzMxMmE0ODI0NGFlODljZTBlYzY4YTlmMjJkYTY5ZjI3Y2U4YSJ9.qhdvDSSAgnPFZz0iNpxDcYWlC6zPC7DmhJxjklbeYD0&download=zl2myyqdee_fo6zxrxfeq.png\"></p>\n<p>④后台用户账号密码泄露；这个一般是在/heapdump 路径下，访问/heapdump 路径，返回 GZip 压缩 hprof 堆转储文件。在 Android studio 打开，会泄露站点内存信息，很多时候会包含后台用户的账号密码（包含漏洞的图片暂时没得，大家记住思路就好了..），通过泄露的账号密码，然后进入后台一番轰炸也不错的。</p>\n<h1 id=\"四、安全措施\"><a href=\"#四、安全措施\" class=\"headerlink\" title=\"四、安全措施\"></a>四、安全措施</h1><p>引入 security 依赖，打开安全限制并进行身份验证；同时设置单独的 Actuator 管理端口并配置不对外网开放。详情请见先知社区<a href=\"https://xz.aliyun.com/t/2233\"><strong>https://xz.aliyun.com/t/2233</strong></a></p>\n","text":"一、actuator介绍Actuator 是 springboot 提供的用来对应用系统进行自省和监控的功能模块，借助于 Actuator 开发者可以很方便地对应用系统某些监控指标进行查看、统计等。在 Actuator 启用的情况下，如果没有做好相关权限控制，非法用户可通过访问默...","link":"","photos":[],"count_time":{"symbolsCount":"2.7k","symbolsTime":"2 mins."},"categories":[{"name":"渗透测试","slug":"渗透测试","count":9,"path":"api/categories/渗透测试.json"}],"tags":[{"name":"渗透测试","slug":"渗透测试","count":9,"path":"api/tags/渗透测试.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#%E4%B8%80%E3%80%81actuator%E4%BB%8B%E7%BB%8D\"><span class=\"toc-text\">一、actuator介绍</span></a></li><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#%E4%BA%8C%E3%80%81%E6%BC%8F%E6%B4%9E%E5%8F%91%E7%8E%B0\"><span class=\"toc-text\">二、漏洞发现</span></a></li><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#%E4%B8%89%E3%80%81%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8\"><span class=\"toc-text\">三、漏洞利用</span></a></li><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#%E5%9B%9B%E3%80%81%E5%AE%89%E5%85%A8%E6%8E%AA%E6%96%BD\"><span class=\"toc-text\">四、安全措施</span></a></li></ol>","author":{"name":"街溜子小王","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"默默学习的街溜子","socials":{"github":"https://github.com/ztohacker","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}},"mapped":true,"prev_post":{"title":"spring boot信息泄露漏洞","uid":"fe6d0336657ab32bcff127817b4afc45","slug":"spring boot信息泄露漏洞","date":"2021-10-13T12:56:13.929Z","updated":"2021-10-13T12:57:24.344Z","comments":true,"path":"api/articles/spring boot信息泄露漏洞.json","keywords":null,"cover":null,"text":"一、路由地址及接口调用详情泄露 开发人员没有意识到地址泄漏会导致安全隐患或者开发环境切换为线上生产环境时，相关人员没有更改配置文件，忘记切换环境配置等 直接访问以下两个 swagger 相关路由，验证漏洞是否存在： /v2/api-docs /swagger-ui.html 其他...","link":"","photos":[],"count_time":{"symbolsCount":"7.4k","symbolsTime":"7 mins."},"categories":[{"name":"渗透测试","slug":"渗透测试","count":9,"path":"api/categories/渗透测试.json"}],"tags":[{"name":"渗透测试","slug":"渗透测试","count":9,"path":"api/tags/渗透测试.json"}],"author":{"name":"街溜子小王","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"默默学习的街溜子","socials":{"github":"https://github.com/ztohacker","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}},"feature":true},"next_post":{"title":"spring boot介绍","uid":"4df23ce2d032e16090d56b72df860ee6","slug":"spring boot介绍","date":"2021-10-13T12:56:08.395Z","updated":"2021-10-13T12:57:01.305Z","comments":true,"path":"api/articles/spring boot介绍.json","keywords":null,"cover":null,"text":"一、路由知识 有些程序员会自定义 /manage、/management 、项目 App 相关名称为 spring 根路径 Spring Boot Actuator 1.x 版本默认内置路由的起始路径为 / ，2.x 版本则统一以 /actuator 为起始路径 Spring B...","link":"","photos":[],"count_time":{"symbolsCount":"1k","symbolsTime":"1 mins."},"categories":[{"name":"渗透测试","slug":"渗透测试","count":9,"path":"api/categories/渗透测试.json"}],"tags":[{"name":"渗透测试","slug":"渗透测试","count":9,"path":"api/tags/渗透测试.json"}],"author":{"name":"街溜子小王","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"默默学习的街溜子","socials":{"github":"https://github.com/ztohacker","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}}}}